(this["webpackJsonplms-react-app"]=this["webpackJsonplms-react-app"]||[]).push([[54],{406:function(e,t,a){"use strict";a.r(t);var r=a(67),n=a.n(r),s=a(68),i=a(9),l=a(10),o=a(12),c=a(11),u=a(0),d=a.n(u),m=a(71),p=a(73),h=a(72),f=a(74),g=a(244),v=a(21),b=a(63),E=a.n(b),x=a(23),y=a(64),w=a(16),S=a(22),k=a(117),V=a(115),C=(a(116),function(e){Object(o.a)(a,e);var t=Object(c.a)(a);function a(e){var r;return Object(i.a)(this,a),(r=t.call(this,e)).componentDidMount=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.props&&r.props.user&&r.props.user.id&&r.props.match&&r.props.match.params&&r.props.match.params.id)){e.next=3;break}return e.next=3,r.setState({class_id:r.props.match.params.id});case 3:case"end":return e.stop()}}),e)}))),r.createNotification=function(e,t){switch(e){case"info":y.NotificationManager.info(t,"",5e3);break;case"success":y.NotificationManager.success(t,"",5e3);break;case"warning":y.NotificationManager.warning(t,"",5e3);break;case"error":y.NotificationManager.error(t,"",5e3)}},r.onDropPhoto=function(e){r.setState({files:e,isValid:{value:!0,text:""}})},r.state={isLoading:!1,deletedRowId:null,showModal:!1,handleCloseModal:!1,name:"",description:"",class_id:"",isValid:{value:!1,text:""},data:[],files:[],filesProgress:0},r}return Object(l.a)(a,[{key:"handleTextChange",value:function(e){this.setState({[e.name]:e.value})}},{key:"handleSubmit",value:function(){var e=Object(s.a)(n.a.mark((function e(t){var a,r,s,i,l,o,c,u,d=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=this.state,r=a.name,s=a.files,i=a.description,l=a.class_id,r||!(r.trim().length<=0)){e.next=5;break}return this.setState({isValid:{value:!0,text:"Please enter valid Lecture Name",name:"name"}}),e.abrupt("return");case 5:if(i||!(i.trim().length<=0)){e.next=8;break}return this.setState({isValid:{value:!0,text:"Please enter valid Lecture Description",name:"description"}}),e.abrupt("return");case 8:if(s.length){e.next=11;break}return this.setState({isValid:{value:!0,text:"Please drop Lecture Video above",name:"files"}}),e.abrupt("return");case 11:return e.next=13,this.setState({filesProgress:0});case 13:o=this,c={onUploadProgress:function(e){var t=Math.round(100*e.loaded/e.total);o.setState({filesProgress:t})}},(u=new FormData).append("files",s[0]),u.append("name",r.trim()),u.append("description",i.trim()),u.append("class_id",l),E.a.post("".concat(x.a.prod,"/api/class/lecture/create"),u,c).then((function(e){d.props.history.push("/faculty/class/list")})).catch((function(e){console.log("Error: ",e.response),e.response&&e.response.status&&(400===e.response.status||500===e.response.status)?500===e.response.status&&"SequelizeUniqueConstraintError"===e.response.data.error.name?d.setState({filesProgress:0,isValid:{value:!0,text:"Lecture with this name already exist",name:"server_error"}}):d.setState({filesProgress:0,isValid:{value:!0,text:e.response.data.msg,name:"server_error"}}):d.setState({filesProgress:0,isValid:{value:!0,text:"Unknown Error",name:"server_error"}})}));case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.files.map((function(e){return d.a.createElement("video",{key:e.name,controls:!0,style:{maxWidth:"100%",maxHeight:"100%"}},d.a.createElement("source",{src:URL.createObjectURL(e)}),"Sorry, your browser doesn't support embedded videos.")}));return d.a.createElement(v.a,null,this.state.isLoading&&d.a.createElement(w.a,null),d.a.createElement(m.a,null,d.a.createElement(y.NotificationContainer,null),d.a.createElement(p.a,null,d.a.createElement(h.a,null,d.a.createElement(h.a.Header,null,d.a.createElement(h.a.Title,{as:"h5"},"Add Video Lecture")),d.a.createElement(h.a.Body,null,d.a.createElement(m.a,null,d.a.createElement(f.a,{className:"col-md-12",onSubmit:function(t){return e.handleSubmit(t)}},d.a.createElement("fieldset",{disabled:this.state.isLoading,className:this.state.isLoading?"opacity-5":""},d.a.createElement(f.a.Row,null,d.a.createElement(p.a,{md:{span:8,offset:2}},d.a.createElement(f.a.Group,{className:"mb-2",controlId:"formBasicEmail"},d.a.createElement(f.a.Label,null,"Lecture Name"),d.a.createElement(f.a.Control,{type:"text",name:"name",placeholder:"Lecture Name",value:this.state.name,className:this.state.isValid.value&&"name"===this.state.isValid.name?"in-valid-input":"",onFocus:function(){return e.setState({isValid:{value:!1,text:""}})},onChange:function(t){return e.handleTextChange(t.target)}})))),d.a.createElement(f.a.Row,null,d.a.createElement(p.a,{md:{span:8,offset:2}},d.a.createElement(f.a.Group,{controlId:"exampleForm.ControlTextarea1"},d.a.createElement(f.a.Label,null,"Lecture Description"),d.a.createElement(f.a.Control,{as:"textarea",name:"description",rows:3,value:this.state.description,className:this.state.isValid.value&&"description"===this.state.isValid.name?"in-valid-input":"",onFocus:function(){return e.setState({isValid:{value:!1,text:""}})},onChange:function(t){return e.handleTextChange(t.target)}})))),d.a.createElement(f.a.Row,null,d.a.createElement(p.a,{md:{span:8,offset:2}},d.a.createElement(k.a,{onDrop:this.onDropPhoto,accept:"video/*",minSize:0,maxSize:1048576e3,multiple:!1},(function(a){var r=a.getRootProps,n=a.getInputProps,s=a.isDragActive,i=a.isDragReject,l=a.rejectedFiles,o=l&&l.length>0&&l[0].size>1048576e3;return d.a.createElement("section",null,d.a.createElement("div",Object.assign({style:{display:"flex",alignItems:"center",justifyContent:"center",borderWidth:2,height:"25em",borderRadius:2,textAlign:"center",borderColor:"#eeeeee",borderStyle:"dashed",backgroundColor:"#fafafa",color:"#bdbdbd"}},r({className:"dropzone",onClick:function(e){return e.stopPropagation()}})),d.a.createElement("input",n()),!s&&!t.length&&"Drop a lecutre video to upload!",s&&!i&&"Drop it like it's hot!",i&&"File type not accepted, sorry!",o&&d.a.createElement("div",{className:"text-danger mt-2"},"File is too large. Max Size 1GB"),t,t.length?d.a.createElement("div",{style:{width:"15%",position:"absolute",padding:14,backgroundColor:"whitesmoke",borderRadius:20}},d.a.createElement(V.a,{value:e.state.filesProgress,text:"".concat(e.state.filesProgress,"%")})):null),e.state.isValid.value&&"files"===e.state.isValid.name?d.a.createElement(f.a.Text,{style:{color:"red"}},e.state.isValid.text):"")})))),d.a.createElement(f.a.Row,null,d.a.createElement(p.a,{md:{span:8,offset:2}},d.a.createElement("div",null,d.a.createElement(g.a,{type:"submit",style:{marginTop:"1.8rem",width:"100%"},variant:"primary"},"Submit"),this.state.isValid.value?d.a.createElement(f.a.Text,{style:{color:"red"}},this.state.isValid.text):"")))))))))))}}]),a}(d.a.Component));t.default=Object(S.b)((function(e){return{user:e.userDetails.user}}),null)(C)}}]);
//# sourceMappingURL=54.8325ac0f.chunk.js.map