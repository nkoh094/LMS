(this["webpackJsonplms-react-app"]=this["webpackJsonplms-react-app"]||[]).push([[44],{105:function(e,t,a){"use strict";a.r(t),a.d(t,"signIn",(function(){return n})),a.d(t,"signOut",(function(){return s}));var n=function(e){return{type:"SIGN_IN",payload:e}},s=function(){return{type:"SIGN_OUT"}}},456:function(e,t,a){"use strict";a.r(t);var n=a(67),s=a.n(n),r=a(68),o=a(9),i=a(10),c=a(26),l=a(12),u=a(11),m=a(0),p=a.n(m),d=(a(217),a(21)),h=a(22),f=a(74),b=a(63),v=a.n(b),g=a(23),E=a(64),N=a(398),k=a.n(N),y=a(105),w=a(461),x=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).facebookResponse=function(e){v.a.post("".concat(g.a.prod,"/api/auth/facebook"),{access_token:e.accessToken}).then((function(e){localStorage.setItem("lms-token",e.data.token),n.props.signIn(e.data.user),e.data.user.status?"user"===e.data.user.role?n.props.history.push("/dashboard"):n.props.history.push("/home"):n.props.history.push("/verify/identity")})).catch((function(e){console.log(e)}))},n.createNotification=function(e,t){switch(e){case"info":E.NotificationManager.info(t,"",5e3);break;case"success":E.NotificationManager.success(t,"",5e3);break;case"warning":E.NotificationManager.warning(t,"",5e3);break;case"error":E.NotificationManager.error(t,"",5e3)}},n.state={email:"",password:"",isValid:{value:!1,text:""}},n.facebookResponse=n.facebookResponse.bind(Object(c.a)(n)),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){localStorage.getItem("lms-token")&&this.props.history.push("/dasboard")}},{key:"handleTextChange",value:function(e){this.setState({[e.name]:e.value})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=this.state,n=a.email,o=a.password;!n&&n.trim().length<=0?this.setState({isValid:{value:!0,text:"Please enter valid Email",name:"email"}}):!o&&o.trim().length<=0?this.setState({isValid:{value:!0,text:"Please enter valid Password",name:"password"}}):v.a.post("".concat(g.a.prod,"/api/user/signin"),{email:n.trim(),password:o.trim()}).then(function(){var e=Object(r.a)(s.a.mark((function e(a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,localStorage.setItem("lms-token",a.data.token);case 2:return e.next=4,t.props.signIn(a.data.user);case 4:a.data.user.status?"admin"===a.data.user.role?t.props.history.push("/admin/dashboard"):"user"===a.data.user.role?t.props.history.push("/dashboard"):t.props.history.push("/home"):t.props.history.push("/verify/identity");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("Error: ",e.response),e.response&&e.response.status&&(404===e.response.status||400===e.response.status||401===e.response.status||500===e.response.status)?(t.setState({isValid:{value:!0,text:e.response.data.msg}}),t.createNotification("error",e.response.data.msg)):(t.setState({isValid:{value:!0,text:"Unknown Error"}}),t.createNotification("error","Unknown Error"))}))}},{key:"render",value:function(){var e=this;return p.a.createElement(d.a,null,p.a.createElement(E.NotificationContainer,null),p.a.createElement("div",{className:"auth-wrapper"},p.a.createElement("div",{className:"auth-content"},p.a.createElement("div",{className:"auth-bg"},p.a.createElement("span",{className:"r"}),p.a.createElement("span",{className:"r s"}),p.a.createElement("span",{className:"r s"}),p.a.createElement("span",{className:"r"})),p.a.createElement("div",{className:"card"},p.a.createElement("div",{className:"card-body text-center"},p.a.createElement("div",{className:"mb-4"},p.a.createElement("i",{className:"feather icon-unlock auth-icon"})),p.a.createElement("h3",{className:"mb-4"},"Login"),p.a.createElement("div",{className:"input-group mb-3"},p.a.createElement("input",{type:"email",className:this.state.isValid.value&&"email"===this.state.isValid.name?"form-control in-valid-input":"form-control",placeholder:"Email",name:"email",onFocus:function(){return e.setState({isValid:{value:!1,text:"",name:""}})},onChange:function(t){return e.handleTextChange(t.target)}})),p.a.createElement("div",{className:"input-group mb-4"},p.a.createElement("input",{type:"password",className:this.state.isValid.value&&"password"===this.state.isValid.name?"form-control in-valid-input":"form-control",placeholder:"password",name:"password",onFocus:function(){return e.setState({isValid:{value:!1,text:"",name:""}})},onChange:function(t){return e.handleTextChange(t.target)}})),p.a.createElement("div",{className:"form-group text-left"},this.state.isValid.value?p.a.createElement(f.a.Text,{style:{color:"red"}},this.state.isValid.text):""),p.a.createElement("div",null,p.a.createElement("button",{style:{width:"100%"},className:"btn btn-primary shadow-2 mb-4",onClick:function(t){return e.handleSubmit(t)}},"Login")),p.a.createElement("div",null,p.a.createElement(k.a,{appId:g.a.REACT_APP_FACEBOOK_APP_ID,autoLoad:!1,fields:"name,email,picture",callback:this.facebookResponse,render:function(e){return p.a.createElement("button",{style:{width:"100%"},className:"btn btn-primary shadow-2 mb-4",onClick:e.onClick},"Facebook Login")}})),p.a.createElement("p",{className:"mb-0 text-muted"},"Create an account? ",p.a.createElement(w.a,{to:"/signup"},"Signup")))))))}}]),a}(p.a.Component);t.default=Object(h.b)((function(e){return{user:e.userDetails}}),y)(x)}}]);
//# sourceMappingURL=44.fdc5b092.chunk.js.map